<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible"
	      content="IE=edge" />
	<title>
		StickyChats - Keep your friends close, and your chats closer
	</title>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async
	        src="https://www.googletagmanager.com/gtag/js?id=UA-154349844-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'UA-154349844-1');
		</script>
	<script src="./vue.js"></script>
	<link rel="stylesheet"
	      href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
	<link href="https://fonts.googleapis.com/css?family=Varela+Round&display=swap"
	      rel="stylesheet" />
	<link rel="stylesheet" href="./style.css">
</head>

<body >
	<div class="macbook-wrapper">
		<img class="mbp-screenshot"
		     src="./mbp.png"
		     alt="macbook-screenshot" />
	</div>
	<div class="hi-friend-wrapper" id="app">
		<div class="hi-friend">
			<h1>Hi there friend,</h1>
			<p>
				I am StickyChats. A nice little Facebook Messenger client,
				probably the best (a bit biased though). Download me to join
				the club and chat with your friends effortlessly. The feed
				can wait for later.
			</p>
			<p>
				Even though the app is very much usable, consider this an
				early alpha version.
			</p>
			<p>Made by <a href="https://twitter.com/altinselimi">@altinselimi</a>. Check out the source code <a href="https://github.com/altinselimi/stickychats">here</a>.</p>
			<button @click="goToLink()"
			   class="download-btn">
				<i color="black"
				   class="fab"
				   :class="{'fa-windows': system === 'windows', 'fa-apple': system === 'mac'}"></i>
				<span style="margin-left: 10px; width: 100%;">Download</span>
			</button>
		</div>
	</div>
</body>
<script>
Vue.config.devtools = true
var app = new Vue({
	el: '#app',
	created() {
		console.log('Created');
		fetch('https://api.github.com/repos/altinselimi/stickychats/releases/latest')
			.then(async res => {
				const jsonResult = await res.json();
				const { assets } = jsonResult;
				const macAsset = assets.find(a => a.name.includes('.dmg'));
				const windowsAsset = assets.find(a => a.name.includes('.exe'));
				if (this.system === 'mac') this.downloadLink = macAsset.browser_download_url;
				else this.downloadLink = windowsAsset.browser_download_url;
			})
	},
	computed: {
		system() {
			if (navigator.platform.indexOf('Mac') > -1) return 'mac';
			return 'windows';
		},
		link() {
			if (this.system === 'mac') {
				return 'https://github.com/altinselimi/monimo/releases/download/v0.2.4/Monimo-0.2.4.dmg';
			}
			return 'https://github.com/altinselimi/monimo/releases/download/v0.2.4/monimo-setup-0.2.4.exe';
		},
	},
	data: () => ({
		downloadLink: null
	}),
	methods: {
		goToLink() {
			window.open(this.downloadLink, '_blank');
		}
	}
});
</script>

</html>
